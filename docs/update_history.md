# 更新履歴

## 2025-03-09 UI改善アップデート

### 1. スケジュール登録フォームの改善

#### 日付選択の改善
- カレンダーマークをクリックしなくても日付を選択できるように改善
- 日付フィールドをクリックするだけでカレンダーが表示されるようにjQuery UIのDatepickerを実装
- 日本語対応のカレンダーを実装（曜日や月名が日本語で表示）
- 日付フィールドにはカレンダーアイコンを表示し、クリック可能であることを明示
- 日付選択フィールドを読み取り専用に設定し、手動入力によるエラーを防止

#### 不要なフィールドの削除
- 開始時間と終了時間のフィールドを完全に削除
- バックエンド（routes.py）も更新して、これらのフィールドを処理しないように変更

#### その他の改善
- ポート番号を指定できるようにrun.pyを修正（ポートが使用中の場合に別のポートで起動可能）
- 入力フィールドの高さと内部パディングを増加（44pxの最小高さを設定）
- フォントサイズを16pxに拡大（モバイルでの自動ズームを防止）
- フォーカス時の視覚的なフィードバックを追加（青い枠とシャドウ）
- ボタンのサイズを大きく（幅と高さ）
- パディングと余白を増加
- モバイル対応の強化（画面幅が768px以下の場合、さらに大きなタッチターゲットを提供）

### 2. 作付け計画なしでのスケジュール登録機能

#### データモデルの変更
- Scheduleモデルのplan_idフィールドをnullable=Trueに変更し、作付け計画なしでもスケジュールを登録できるように

#### テンプレートの変更
- 作付け計画がない場合でもフォームフィールドを有効化
- 警告メッセージを情報メッセージに変更
- 作付け計画と圃場選択の連動処理を実装（作付け計画が選択されている場合は圃場選択を無効化）

#### ルートハンドラの変更
- 作付け計画IDが空の場合はNoneに変換するロジックを追加
- 圃場IDの処理を追加

## 今後の予定機能

### 作物のフローと日数登録機能

#### 概要
- 作物ごとの栽培ステージ（播種、苗管理、植え付け、収穫など）とそれにかかる日数を登録
- 作付け計画と連動させ、開始日を入力すると他のステージの予定日を自動計算
- すべてのステージを作業予定として自動登録する機能

#### 実装予定の機能
- 作物登録・編集画面に栽培ステージの登録機能を追加
- 作付け計画登録時に、関連するステージ情報に基づいて作業予定を自動生成
- 各ステージの予定日を視覚的に表示

#### 技術的な詳細
- CropStageモデルの追加（作物ID、ステージ名、開始日からの日数、説明、順序）
- 作物とステージの関連付け
- 日付計算ロジックの実装
- 動的なフォーム操作のためのJavaScript実装
